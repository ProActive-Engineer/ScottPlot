name: Publish on NuGet

on:
  workflow_dispatch:

jobs:
  publish:
    runs-on: windows-latest
    name: Build and Publish
    steps:
      - name: 🛒 Checkout
        uses: actions/checkout@v2
      - name: 🐢 Set up MSBuild
        uses: microsoft/setup-msbuild@v1.0.3
      - name: 🚚 Restore
        working-directory: src
        run: dotnet restore
      - name: 🐌 MSBuild
        working-directory: src
        run: msbuild -property:Configuration=Release -verbosity:minimal
      - name: 🚀 Publish
        run: |
          nuget push src/ScottPlot/bin/Release/*.nupkg
          nuget push src/controls/ScottPlot.WinForms/bin/Release/*.nupkg
          nuget push src/controls/ScottPlot.WPF/bin/Release/*.nupkg
          nuget push src/controls/ScottPlot.Avalonia/bin/Release/*.nupkg
